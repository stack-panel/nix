<!-- Generated by stackpanel - edits will be overwritten -->
# Secrets

Encrypted with [SOPS](https://github.com/getsops/sops) + AGE.

## Usage

```bash
# Edit secrets for an environment
sops secrets/dev.yaml
sops secrets/staging.yaml
sops secrets/production.yaml

# Common secrets (shared across all environments)
sops secrets/common.yaml
```

## Local Overrides

Create `secrets/{env}.local.yaml` for local-only secrets (gitignored):

```bash
# Copy dev secrets as a starting point
sops -d secrets/dev.yaml > secrets/dev.local.yaml
# Edit as needed, then encrypt
sops -e -i secrets/dev.local.yaml
```

## In Code

Use [sops exec-env](https://github.com/getsops/sops#exec-env) to load secrets:

```bash
# Run with dev secrets
sops exec-env secrets/dev.yaml './start-server.sh'

# Or with local overrides (if exists)
sops exec-env secrets/dev.local.yaml './start-server.sh'
```

## Adding Team Members

1. Get their AGE public key: `age-keygen -y ~/.age/key.txt`
2. Add to `flake.nix` under `stackpanel.secrets.users`
3. Run `nix run .#generate`
4. Re-encrypt secrets: `sops updatekeys secrets/dev.yaml`

